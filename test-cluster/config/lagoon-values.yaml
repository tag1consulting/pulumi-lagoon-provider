# Lagoon Core Helm Chart Values
# Simplified configuration for local testing with kind

# Required Harbor configuration
harborURL: "https://harbor.lagoon.test"
harborAdminPassword: "Harbor12345"

# Keycloak frontend URL (for redirects)
# Note: Don't include /auth suffix - the Helm chart will add it
keycloakFrontEndURL: "https://keycloak.lagoon.test"

# S3 configuration (required - using dummy values for local testing)
s3FilesAccessKeyID: "local-test-key"
s3FilesSecretAccessKey: "local-test-secret"
s3FilesBucket: "lagoon-files"
s3FilesHost: "http://localhost:9000"  # Dummy S3 endpoint
s3FilesRegion: "us-east-1"

# Database credentials (for backups - using dummy values)
s3BAASAccessKeyID: "local-test-key"
s3BAASSecretAccessKey: "local-test-secret"

# Elasticsearch configuration (using dummy URL - not actually deployed)
elasticsearchURL: "http://elasticsearch.lagoon.test:9200"

# Kibana configuration (using dummy URL - not actually deployed)
kibanaURL: "http://kibana.lagoon.test:5601"

# Global Lagoon settings
lagoon:
  # Use local/test domain
  baseDomain: "lagoon.test"

  # API configuration
  api:
    # Enable admin user for testing
    adminUsername: "admin"
    # Note: password will be auto-generated and can be retrieved via kubectl

  # Database configuration - use in-cluster databases for simplicity
  database:
    type: "embedded"

  # SSH configuration (for git operations)
  ssh:
    enabled: false  # Disable SSH for simplified local testing

# UI configuration
ui:
  enabled: true
  replicaCount: 1

# Configure Lagoon API URL (used by UI)
lagoonAPIURL: "https://api.lagoon.test/graphql"

# Configure Lagoon webhook URL (used by UI)
lagoonWebhookURL: "https://webhook-handler.lagoon.test"

# Webhooks handler
webhooks:
  enabled: true
  replicaCount: 1

# Build/task queue (RabbitMQ broker)
broker:
  # Disable ServiceMonitor (requires Prometheus Operator)
  serviceMonitor:
    enabled: false
  # Use minimal resources for local testing
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"

# Keycloak configuration
keycloak:
  # Disable ServiceMonitor (requires Prometheus Operator)
  serviceMonitor:
    enabled: false

# SSH services
ssh:
  # Disable ServiceMonitor (requires Prometheus Operator)
  serviceMonitor:
    enabled: false

# Storage
storage:
  # Use local storage class for testing
  storageClass: "standard"

# Resource limits - reduced for local development
resources:
  api:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  ui:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"

# Disable features not needed for basic provider testing
# Backup handler component
backupHandler:
  enabled: false

# Service monitors (requires Prometheus Operator)
metrics:
  serviceMonitor:
    enabled: false

# Debug mode for better error messages
debug:
  enabled: true
